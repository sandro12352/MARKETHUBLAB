<!-- ═══════════════════════════════════════════════════════════════════
     FOLDER CONTENT — Refined Editorial Dark Theme
     ═══════════════════════════════════════════════════════════════════ -->

<div class="relative max-w-7xl mx-auto px-6 py-8 space-y-10">

    <!-- ── Ambient Background Glow ── -->
    <div class="fixed top-0 left-64 right-0 h-full overflow-hidden -z-10 pointer-events-none">
        <div class="absolute -top-[10%] right-[10%] w-[500px] h-[500px] rounded-full blur-[160px] bg-indigo-600/[0.04]">
        </div>
        <div class="absolute bottom-[20%] left-[10%] w-[400px] h-[400px] rounded-full blur-[140px] bg-blue-600/[0.03]">
        </div>
    </div>

    <!-- ── Top Navigation / Breadcrumb ── -->
    <div class="fold-entrance flex items-center justify-between gap-4">
        <div class="flex items-center gap-2">
            <button [routerLink]="'/home/projects/' + id_proyecto"
                class="group flex items-center gap-2 px-4 py-2 bg-white/[0.02] hover:bg-white/[0.06] border border-white/[0.06] rounded-xl text-[11px] font-bold uppercase tracking-widest text-neutral-500 hover:text-white transition-all">
                <iconify-icon icon="lucide:arrow-left" width="14"
                    class="transition-transform group-hover:-translate-x-1"></iconify-icon>
                Volver
            </button>
            <div class="h-4 w-[1px] bg-white/10 mx-1"></div>
            <p class="text-[11px] font-bold uppercase tracking-widest text-neutral-600">Material de Proyecto</p>
        </div>

        @if (folder()) {
        <div class="px-4 py-2 bg-white/[0.03] border border-white/[0.06] rounded-xl">
            <span class="text-[11px] font-medium text-neutral-400 flex items-center gap-2">
                <span class="w-1.5 h-1.5 bg-indigo-400 rounded-full fold-glow-dot"></span>
                {{ folderContents().length }} Archivos en esta categoría
            </span>
        </div>
        }
    </div>

    @if (folder()) {
    <!-- ═══════════════════════ FOLDER HEADER ═══════════════════════ -->
    <div
        class="fold-entrance fold-entrance-delay-1 flex flex-col md:flex-row items-start md:items-end justify-between gap-6">
        <div class="flex items-center gap-5">
            <div
                class="w-16 h-16 rounded-2xl bg-indigo-500/10 border border-indigo-500/15 flex items-center justify-center text-indigo-400 shadow-lg shadow-indigo-500/5">
                <iconify-icon [icon]="folder()!.icono || 'lucide:folder'" width="32"></iconify-icon>
            </div>
            <div class="space-y-1">
                <h1 class="fold-display-font text-3xl font-extrabold text-white tracking-tight">
                    {{ folder()!.nombre }}
                </h1>
                <p class="text-sm text-neutral-500 max-w-xl">
                    {{ folder()!.descripcion || 'Contenido y material audiovisual organizado para esta categoría.' }}
                </p>
            </div>
        </div>

        <div class="flex items-center gap-3 w-full md:w-auto">
            <!-- View Toggle -->
            <button (click)="toggleViewMode()"
                class="flex-1 md:flex-none px-4 py-2.5 bg-white/[0.02] hover:bg-white/[0.08] border border-white/5 text-neutral-400 hover:text-white transition-all rounded-xl flex items-center justify-center gap-2">
                <iconify-icon [icon]="viewMode() === 'grid' ? 'lucide:list' : 'lucide:layout-grid'"
                    width="16"></iconify-icon>
                <span class="text-[11px] font-bold uppercase tracking-widest">{{ viewMode() === 'grid' ? 'Lista' :
                    'Grilla' }}</span>
            </button>

            <!-- Upload Trigger -->
            <hlm-alert-dialog>
                <button hlmAlertDialogTrigger (click)="resetContentForm()"
                    class="flex-1 md:flex-none px-6 py-2.5 bg-indigo-600 hover:bg-indigo-500 text-white rounded-xl font-bold text-sm shadow-lg shadow-indigo-600/20 transition-all flex items-center justify-center gap-2">
                    <iconify-icon icon="lucide:upload" width="16"></iconify-icon>
                    Subir Material
                </button>

                <!-- Upload Modal -->
                <hlm-alert-dialog-content class="sm:max-w-[560px] bg-[#0c0d14] border-white/10 p-0 overflow-hidden"
                    *brnAlertDialogContent="let ctx">
                    <div class="px-6 py-5 border-b border-white/[0.06] flex items-center gap-3">
                        <div
                            class="w-9 h-9 rounded-xl bg-indigo-500/10 flex items-center justify-center text-indigo-400">
                            <iconify-icon icon="lucide:cloud-upload" width="18"></iconify-icon>
                        </div>
                        <div>
                            <h2 class="fold-display-font text-lg font-bold text-white">Subir Material</h2>
                            <p class="text-[10px] text-neutral-500 uppercase tracking-widest mt-0.5">Nuevos archivos
                                para {{ folder()!.nombre }}</p>
                        </div>
                    </div>

                    <div class="p-6 space-y-6">
                        <!-- Drag & Drop Zone -->
                        <div class="relative" (dragover)="onDragOver($event)" (dragleave)="onDragLeave($event)"
                            (drop)="onDrop($event)">
                            @if (!selectedFile()) {
                            <label for="file-upload"
                                class="flex flex-col items-center justify-center py-10 px-6 rounded-2xl border-2 border-dashed transition-all duration-300 cursor-pointer"
                                [ngClass]="isDragging() ? 'border-indigo-500/50 bg-indigo-500/5' : 'border-white/10 bg-white/[0.015] hover:border-white/20 hover:bg-white/[0.03]'">
                                <iconify-icon icon="lucide:file-up" width="32" class="mb-4"
                                    [ngClass]="isDragging() ? 'text-indigo-400' : 'text-neutral-700'"></iconify-icon>
                                <p class="text-[14px] text-neutral-300 font-bold tracking-tight mb-1">
                                    {{ isDragging() ? '¡Suelta para subir!' : 'Arrastra y suelta aquí' }}
                                </p>
                                <p class="text-xs text-neutral-600 tracking-wide font-medium">o selecciona desde tu
                                    dispositivo</p>
                                <input id="file-upload" type="file" class="hidden" (change)="onFileSelected($event)"
                                    accept="image/*,video/*,.pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx" />
                            </label>
                            } @else {
                            <div class="rounded-2xl border border-white/10 bg-white/[0.015] p-5 space-y-4">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center gap-4">
                                        <div
                                            [class]="'w-12 h-12 rounded-xl flex items-center justify-center shadow-lg ' + getFileBgColor(getSelectedFileType())">
                                            <iconify-icon [icon]="getFileIcon(getSelectedFileType())" width="22"
                                                [ngClass]="getFileIconColor(getSelectedFileType())"></iconify-icon>
                                        </div>
                                        <div class="min-w-0">
                                            <p class="text-white font-bold text-sm truncate max-w-[240px]">{{
                                                selectedFile()!.name }}</p>
                                            <p
                                                class="text-neutral-600 text-[10px] font-black uppercase tracking-widest">
                                                {{ (selectedFile()!.size) + "MB"}}</p>
                                        </div>
                                    </div>
                                    <button (click)="resetContentForm()"
                                        class="p-2 text-neutral-600 hover:text-red-400 transition-colors">
                                        <iconify-icon icon="lucide:x" width="18"></iconify-icon>
                                    </button>
                                </div>

                                @if (previewUrl()) {
                                <div class="rounded-xl overflow-hidden border border-white/5 ring-1 ring-white/10">
                                    @if (getSelectedFileType() === 'imagen') {
                                    <img [src]="previewUrl()" alt="Preview" class="w-full h-40 object-cover" />
                                    } @else if (getSelectedFileType() === 'video') {
                                    <video [src]="previewUrl()" class="w-full h-40 object-cover" controls></video>
                                    }
                                </div>
                                }
                            </div>
                            }
                        </div>

                        <!-- Metadata Form -->
                        <form [formGroup]="contentForm" class="space-y-4">
                            <div class="space-y-1.5">
                                <label
                                    class="text-[10px] font-bold uppercase tracking-[0.15em] text-neutral-500 ml-1">Nombre
                                    Descriptivo *</label>
                                <input formControlName="nombre" type="text" placeholder="Ej: Storyboard Escena 01..."
                                    class="w-full px-4 py-2.5 bg-white/[0.03] border border-white/[0.08] rounded-xl text-sm text-neutral-200 placeholder:text-neutral-700 focus:ring-1 focus:ring-indigo-500/30 focus:border-indigo-500/30 transition-all outline-none" />
                            </div>

                            <div class="space-y-1.5">
                                <label
                                    class="text-[10px] font-bold uppercase tracking-[0.15em] text-neutral-500 ml-1">Observación
                                    (Opcional)</label>
                                <textarea formControlName="descripcion"
                                    placeholder="Explica brevemente qué es este archivo..."
                                    class="w-full px-4 py-2.5 bg-white/[0.03] border border-white/[0.08] rounded-xl text-sm text-neutral-200 placeholder:text-neutral-700 focus:ring-1 focus:ring-indigo-500/30 focus:border-indigo-500/30 transition-all outline-none resize-none min-h-[80px]"></textarea>
                            </div>
                        </form>
                    </div>

                    <div class="px-6 py-4 border-t border-white/[0.06] flex items-center justify-end gap-3">
                        <button hlmBtn variant="ghost" (click)="ctx.close(); resetContentForm()"
                            class="text-neutral-500 hover:text-white">Cancelar</button>
                        <button (click)="onSubmitContent(ctx)" [disabled]="contentForm.invalid || isUploading()"
                            class="px-6 py-2.5 bg-indigo-600 hover:bg-indigo-500 disabled:bg-neutral-800 disabled:text-neutral-600 text-white rounded-xl font-bold text-sm shadow-lg shadow-indigo-600/15 transition-all flex items-center gap-2">
                            @if (isUploading()) {
                            <iconify-icon icon="lucide:loader-2" class="animate-spin" width="16"></iconify-icon>
                            Subiendo...
                            } @else {
                            <iconify-icon icon="lucide:upload-cloud" width="16"></iconify-icon>
                            Iniciar Subida
                            }
                        </button>
                    </div>
                </hlm-alert-dialog-content>
            </hlm-alert-dialog>
        </div>
    </div>

    <!-- ═══════════════════════ STATS BAR ═══════════════════════ -->
    <div class="fold-entrance fold-entrance-delay-2 grid grid-cols-2 lg:grid-cols-4 gap-4">
        <div
            class="p-5 rounded-2xl bg-white/[0.02] border border-white/[0.06] det-grain relative overflow-hidden group">
            <div class="relative z-10">
                <iconify-icon icon="lucide:files" width="16" class="text-indigo-400 mb-2"></iconify-icon>
                <div class="flex items-end gap-1">
                    <p class="fold-display-font text-2xl font-bold text-white">{{ folderContents().length }}</p>
                    <p class="text-[10px] font-bold text-neutral-600 mb-1 uppercase tracking-widest">Total</p>
                </div>
            </div>
        </div>
        <div
            class="p-5 rounded-2xl bg-white/[0.02] border border-white/[0.06] det-grain relative overflow-hidden group">
            <div class="relative z-10">
                <iconify-icon icon="lucide:image" width="16" class="text-emerald-400 mb-2"></iconify-icon>
                <div class="flex items-end gap-1">
                    <p class="fold-display-font text-2xl font-bold text-white">{{ imageCount() }}</p>
                    <p class="text-[10px] font-bold text-neutral-600 mb-1 uppercase tracking-widest">Imágenes</p>
                </div>
            </div>
        </div>
        <div
            class="p-5 rounded-2xl bg-white/[0.02] border border-white/[0.06] det-grain relative overflow-hidden group">
            <div class="relative z-10">
                <iconify-icon icon="lucide:video" width="16" class="text-purple-400 mb-2"></iconify-icon>
                <div class="flex items-end gap-1">
                    <p class="fold-display-font text-2xl font-bold text-white">{{ videoCount() }}</p>
                    <p class="text-[10px] font-bold text-neutral-600 mb-1 uppercase tracking-widest">Videos</p>
                </div>
            </div>
        </div>
        <div
            class="p-5 rounded-2xl bg-white/[0.02] border border-white/[0.06] det-grain relative overflow-hidden group">
            <div class="relative z-10">
                <iconify-icon icon="lucide:file-text" width="16" class="text-blue-400 mb-2"></iconify-icon>
                <div class="flex items-end gap-1">
                    <p class="fold-display-font text-2xl font-bold text-white">{{ docCount() }}</p>
                    <p class="text-[10px] font-bold text-neutral-600 mb-1 uppercase tracking-widest">Docs</p>
                </div>
            </div>
        </div>
    </div>

    <!-- ═══════════════════════ CONTENT AREA ═══════════════════════ -->
    <div class="fold-entrance fold-entrance-delay-2 min-h-[40vh]">
        @if (isLoading()) {
        <div class="flex flex-col items-center justify-center py-20 gap-4">
            <iconify-icon icon="lucide:loader-2" width="32" class="text-indigo-400 animate-spin"></iconify-icon>
            <p class="text-[11px] font-black uppercase tracking-[0.2em] text-neutral-600">Sincronizando Archivos...</p>
        </div>
        } @else if (folderContents().length === 0) {
        <div
            class="flex flex-col items-center justify-center py-32 gap-6 rounded-3xl bg-white/[0.015] border border-dashed border-white/10 det-grain">
            <div class="w-20 h-20 rounded-3xl bg-white/[0.02] border border-white/5 flex items-center justify-center">
                <iconify-icon icon="lucide:file-question" width="40" class="text-neutral-700"></iconify-icon>
            </div>
            <div class="text-center space-y-1.5">
                <h3 class="fold-display-font text-xl font-bold text-neutral-400">Carpeta vacía</h3>
                <p class="text-sm text-neutral-600 max-w-xs mx-auto leading-relaxed">No hay material cargado en esta
                    categoría. Comienza subiendo tus archivos.</p>
            </div>
        </div>
        } @else {

        <!-- ── GRID VIEW ── -->
        @if (viewMode() === 'grid') {
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 pb-20">
            @for (content of folderContents(); track content.id_proyecto_material) {
            <div
                class="file-card group relative bg-white/[0.012] border border-white/[0.06] rounded-2xl overflow-hidden det-grain flex flex-col">

                <!-- Header Accént -->
                <div [class]="'absolute top-0 left-0 right-0 h-1 ' +
                  (content.estado === 'aprobado' ? 'bg-emerald-500/40' : 'bg-indigo-500/20')"></div>

                <!-- Preview Area -->
                <div class="relative h-44 bg-neutral-950 flex items-center justify-center overflow-hidden cursor-pointer"
                    (click)="openPreview(content)">
                    @if (isImage(content)) {
                    <img [src]="content.ruta" [alt]="content.nombre"
                        class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-110" />
                    } @else if (isVideo(content)) {
                    <video [src]="content.ruta" class="w-full h-full object-cover" muted></video>
                    <div class="absolute inset-0 bg-black/40 flex items-center justify-center">
                        <div
                            class="w-12 h-12 rounded-full bg-white/10 backdrop-blur-md border border-white/20 flex items-center justify-center group-hover:bg-white/20 transition-all">
                            <iconify-icon icon="lucide:play" width="22" class="text-white ml-1"></iconify-icon>
                        </div>
                    </div>
                    } @else {
                    <div
                        [class]="'w-16 h-16 rounded-2xl border flex items-center justify-center transition-transform group-hover:scale-110 duration-500 ' + getFileBgColor(content.tipo)">
                        <iconify-icon [icon]="getFileIcon(content.tipo)" width="32"
                            [ngClass]="getFileIconColor(content.tipo)"></iconify-icon>
                    </div>
                    }

                    <!-- Floating Badges -->
                    <div class="absolute top-3 left-3 flex flex-col gap-1.5">
                        <span [class]="'px-2 py-0.5 rounded-md text-[9px] font-black uppercase tracking-widest border backdrop-blur-md ' +
                        (content.tipo === 'image' ? 'bg-emerald-500/10 text-emerald-400 border-emerald-500/20' :
                         content.tipo === 'video' ? 'bg-purple-500/10 text-purple-400 border-purple-500/20' :
                         'bg-blue-500/10 text-blue-400 border-blue-500/20')">
                            {{ getTypeLabel(content.tipo) }}
                        </span>
                    </div>

                    <!-- Hover Overlay -->
                    <div
                        class="absolute inset-0 bg-indigo-600/10 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center">
                        <div
                            class="w-10 h-10 rounded-full bg-white/20 backdrop-blur-md border border-white/40 flex items-center justify-center">
                            <iconify-icon icon="lucide:maximize-2" width="18" class="text-white"></iconify-icon>
                        </div>
                    </div>
                </div>

                <!-- Info Area -->
                <div class="p-5 space-y-4 flex-1">
                    <div class="space-y-1">
                        <h4
                            class="fold-display-font text-sm font-bold text-white line-clamp-1 group-hover:text-indigo-400 transition-colors">
                            {{ content.nombre }}
                        </h4>
                        <p class="text-[11px] text-neutral-600 line-clamp-2 min-h-[2rem]">
                            {{ content.descripcion || 'Sin información adicional.' }}
                        </p>
                    </div>

                    <div class="pt-4 border-t border-white/[0.04] flex flex-col gap-3">
                        <div class="flex items-center justify-between">
                            <div class="flex items-center gap-2">
                                <div
                                    class="w-5 h-5 rounded-full bg-indigo-500/10 border border-white/5 flex items-center justify-center text-indigo-400">
                                    <iconify-icon icon="lucide:user" width="11"></iconify-icon>
                                </div>
                                <span class="text-[11px] font-medium text-neutral-400 truncate max-w-[80px]">
                                    {{ content.trabajador ? (content.trabajador.nombres + ' ' +
                                    content.trabajador.apellidos.charAt(0) + '.') : 'Sistema' }}
                                </span>
                            </div>
                            <span class="text-[10px] font-black uppercase tracking-widest text-neutral-600">{{
                                content.tamanio }}MB</span>
                        </div>

                        <div class="flex items-center justify-between gap-2">
                            <span
                                [class]="'px-2 py-0.5 rounded text-[9px] font-black uppercase tracking-widest border ' + getStatusClasses(content.estado)">
                                {{ getStatusLabel(content.estado) }}
                            </span>
                            <div class="flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-all">
                                @if (content.estado !== 'aprobado' && content.ruta) {
                                <button (click)="approveContent(content); $event.stopPropagation()"
                                    class="p-2 bg-emerald-500/10 hover:bg-emerald-500/20 text-emerald-400 rounded-lg transition-all"
                                    title="Aprobar">
                                    <iconify-icon icon="lucide:check-circle-2" width="14"></iconify-icon>
                                </button>
                                }
                                <button (click)="deleteContent(content.id_proyecto_material!); $event.stopPropagation()"
                                    class="p-2 bg-white/[0.03] hover:bg-red-500/10 text-neutral-600 hover:text-red-400 rounded-lg transition-all"
                                    title="Eliminar">
                                    <iconify-icon icon="lucide:trash-2" width="14"></iconify-icon>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            }
        </div>
        }

        <!-- ── LIST VIEW ── -->
        @else {
        <div class="bg-white/[0.015] border border-white/[0.06] rounded-2xl overflow-hidden det-grain pb-20">
            <table class="w-full">
                <thead class="bg-white/[0.01] border-b border-white/[0.06]">
                    <tr>
                        <th
                            class="px-6 py-4 text-left text-[10px] font-black uppercase tracking-widest text-neutral-600">
                            Material</th>
                        <th
                            class="px-6 py-4 text-left text-[10px] font-black uppercase tracking-widest text-neutral-600">
                            Tipo</th>
                        <th
                            class="px-6 py-4 text-left text-[10px] font-black uppercase tracking-widest text-neutral-600">
                            Subido por</th>
                        <th
                            class="px-6 py-4 text-center text-[10px] font-black uppercase tracking-widest text-neutral-600">
                            Estado</th>
                        <th
                            class="px-6 py-4 text-right text-[10px] font-black uppercase tracking-widest text-neutral-600">
                            Acciones</th>
                    </tr>
                </thead>
                <tbody class="divide-y divide-white/[0.03]">
                    @for (content of folderContents(); track content.id_proyecto_material) {
                    <tr class="group hover:bg-white/[0.02] transition-colors cursor-pointer"
                        (click)="openPreview(content)">
                        <td class="px-6 py-4">
                            <div class="flex items-center gap-4">
                                <div
                                    [class]="'w-10 h-10 rounded-xl flex items-center justify-center shrink-0 ' + getFileBgColor(content.tipo)">
                                    <iconify-icon [icon]="getFileIcon(content.tipo)" width="18"
                                        [ngClass]="getFileIconColor(content.tipo)"></iconify-icon>
                                </div>
                                <div class="min-w-0">
                                    <p
                                        class="text-[13px] font-bold text-white group-hover:text-indigo-400 transition-colors truncate">
                                        {{ content.nombre }}</p>
                                    <p class="text-[11px] text-neutral-600 truncate max-w-[200px]">{{
                                        content.descripcion || 'Sin descripción' }}</p>
                                </div>
                            </div>
                        </td>
                        <td class="px-6 py-4">
                            <span class="text-[11px] font-bold text-neutral-500 uppercase tracking-widest">{{
                                getTypeLabel(content.tipo) }}</span>
                        </td>
                        <td class="px-6 py-4">
                            <div class="flex items-center gap-2">
                                <iconify-icon icon="lucide:user" width="12" class="text-indigo-500/40"></iconify-icon>
                                <span class="text-[12px] text-neutral-300 font-medium">
                                    {{ content.trabajador ? (content.trabajador.nombres + ' ' +
                                    content.trabajador.apellidos) : 'Sistema' }}
                                </span>
                            </div>
                        </td>
                        <td class="px-6 py-4 text-center">
                            <span
                                [class]="'px-2 py-0.5 rounded text-[9px] font-black uppercase tracking-widest border inline-block ' + getStatusClasses(content.estado)">
                                {{ getStatusLabel(content.estado) }}
                            </span>
                        </td>
                        <td class="px-6 py-4 text-right">
                            <div
                                class="flex items-center justify-end gap-1.5 opacity-0 group-hover:opacity-100 transition-opacity">
                                @if (content.estado !== 'aprobado' && content.ruta) {
                                <button (click)="approveContent(content); $event.stopPropagation()"
                                    class="p-2 bg-emerald-500/10 hover:bg-emerald-500/20 text-emerald-400 rounded-lg transition-all"
                                    title="Aprobar">
                                    <iconify-icon icon="lucide:check-circle-2" width="15"></iconify-icon>
                                </button>
                                }
                                <button (click)="downloadFile(content); $event.stopPropagation()"
                                    class="p-2 bg-white/[0.03] hover:bg-white/10 text-neutral-500 hover:text-white rounded-lg transition-all"
                                    title="Descargar">
                                    <iconify-icon icon="lucide:download" width="15"></iconify-icon>
                                </button>
                                <button (click)="deleteContent(content.id_proyecto_material!); $event.stopPropagation()"
                                    class="p-2 bg-white/[0.03] hover:bg-red-500/10 text-neutral-600 hover:text-red-400 rounded-lg transition-all"
                                    title="Eliminar">
                                    <iconify-icon icon="lucide:trash-2" width="15"></iconify-icon>
                                </button>
                            </div>
                        </td>
                    </tr>
                    }
                </tbody>
            </table>
        </div>
        }
        }
    </div>
    } @else {
    <!-- Loading State -->
    <div class="flex flex-col items-center justify-center min-h-[60vh] gap-6">
        <div class="w-16 h-16 rounded-full border-4 border-indigo-500/10 border-t-indigo-500 animate-spin"></div>
        <p class="fold-display-font text-sm font-bold text-neutral-500 uppercase tracking-widest animate-pulse">
            Cargando...</p>
    </div>
    }
</div>

<!-- ════════════════════════════════════════════════════════════════
     PREVIEW MODAL
     ════════════════════════════════════════════════════════════════ -->
@if (previewContent()) {
<div class="fixed inset-0 z-[100] flex items-center justify-center bg-black/95 backdrop-blur-xl animate-in fade-in duration-300"
    (click)="closePreview()">

    <!-- Header Controls -->
    <div
        class="absolute top-0 inset-x-0 h-20 px-8 flex items-center justify-between z-[110] bg-linear-to-b from-black/80 to-transparent">
        <div class="flex items-center gap-4">
            <div
                [class]="'w-10 h-10 rounded-xl flex items-center justify-center ' + getFileBgColor(previewContent()!.tipo)">
                <iconify-icon [icon]="getFileIcon(previewContent()!.tipo)" width="20"
                    [ngClass]="getFileIconColor(previewContent()!.tipo)"></iconify-icon>
            </div>
            <div>
                <h4 class="fold-display-font text-base font-bold text-white">{{ previewContent()!.nombre }}</h4>
                <p class="text-[10px] text-neutral-500 uppercase tracking-[0.2em] font-black">{{
                    previewContent()!.tamanio }}MB • {{ previewContent()!.fecha_subida | date:'dd MMM, yyyy' }}</p>
            </div>
        </div>

        <div class="flex items-center gap-3">
            @if (previewContent()!.estado !== 'aprobado' && previewContent()!.ruta) {
            <button (click)="approveContent(previewContent()!); closePreview(); $event.stopPropagation()"
                class="px-5 py-2 bg-emerald-600 hover:bg-emerald-500 text-white rounded-xl text-xs font-bold uppercase tracking-widest transition-all flex items-center gap-2">
                <iconify-icon icon="lucide:check-circle" width="16"></iconify-icon>
                Aprobar Material
            </button>
            }
            <button (click)="downloadFile(previewContent()!); $event.stopPropagation()"
                class="p-3 bg-white/5 hover:bg-white/10 text-white rounded-xl transition-all" title="Descargar">
                <iconify-icon icon="lucide:download" width="20"></iconify-icon>
            </button>
            <button (click)="closePreview()"
                class="p-3 bg-white/5 hover:bg-white/20 text-white rounded-xl transition-all">
                <iconify-icon icon="lucide:x" width="20"></iconify-icon>
            </button>
        </div>
    </div>

    <!-- Main Content View -->
    <div class="relative w-full h-full p-24 flex items-center justify-center" (click)="$event.stopPropagation()">
        @if (isImage(previewContent()!)) {
        <img [src]="previewContent()!.ruta" [alt]="previewContent()!.nombre"
            class="max-w-full max-h-full object-contain rounded-xl shadow-[0_0_100px_-20px_rgba(0,0,0,0.8)] animate-in zoom-in-95 duration-500" />
        } @else if (isVideo(previewContent()!)) {
        <div
            class="relative w-full max-w-5xl aspect-video rounded-2xl overflow-hidden shadow-2xl bg-black animate-in zoom-in-95 duration-500">
            <video [src]="previewContent()!.ruta" controls autoplay class="w-full h-full"></video>
        </div>
        } @else {
        <div class="flex flex-col items-center gap-6 animate-in slide-in-from-bottom-5 duration-500">
            <div
                [class]="'w-32 h-32 rounded-[2.5rem] border-4 border-white/10 flex items-center justify-center shadow-2xl ' + getFileBgColor(previewContent()!.tipo)">
                <iconify-icon [icon]="getFileIcon(previewContent()!.tipo)" width="64"
                    [ngClass]="getFileIconColor(previewContent()!.tipo)"></iconify-icon>
            </div>
            <div class="text-center space-y-2">
                <p class="fold-display-font text-2xl font-bold text-white">Vista previa no disponible</p>
                <p class="text-neutral-500 max-w-xs mx-auto leading-relaxed">Este tipo de archivo debe descargarse para
                    ser visualizado correctamente.</p>
            </div>
            <button (click)="downloadFile(previewContent()!)"
                class="px-8 py-3 bg-white hover:bg-neutral-200 text-black rounded-2xl font-black uppercase tracking-[0.15em] text-xs transition-all flex items-center gap-3">
                <iconify-icon icon="lucide:download" width="18"></iconify-icon>
                Descargar ahora
            </button>
        </div>
        }
    </div>

    <!-- Description Overlay (Bottom) -->
    @if (previewContent()!.descripcion) {
    <div class="absolute bottom-0 inset-x-0 p-10 bg-linear-to-t from-black/80 to-transparent">
        <div class="max-w-2xl mx-auto text-center space-y-2">
            <p class="text-[10px] font-black uppercase tracking-[0.25em] text-indigo-400">Observaciones</p>
            <p class="text-[15px] text-neutral-300 leading-relaxed font-medium">{{ previewContent()!.descripcion }}</p>
        </div>
    </div>
    }
</div>
}

<hlm-toaster />